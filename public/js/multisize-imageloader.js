!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e){!function(t){"use strict";var e="File format is not recognized.",n="CRC failed.",i="File contains encrypted entry.",r="File is using Zip64 (4gb+ file size).",a="Error while reading zip file.",o="Error while writing zip file.",s="Error while writing file data.",c="Error while reading file data.",u="File already exists.",f=524288,h="text/plain";try{B=0===new Blob([new DataView(new ArrayBuffer(0))]).size}catch(t){}function l(){this.crc=-1}function p(){}function d(t,e){var n,i;return n=new ArrayBuffer(t),i=new Uint8Array(n),e&&i.set(e,0),{buffer:n,array:i,view:new DataView(n)}}function g(){}function m(t){var e,n=this;n.size=0,n.init=function(i,r){var a=new Blob([t],{type:h});(e=new y(a)).init(function(){n.size=e.size,i()},r)},n.readUint8Array=function(t,n,i,r){e.readUint8Array(t,n,i,r)}}function w(e){var n,i=this;i.size=0,i.init=function(t){for(var r=e.length;"="==e.charAt(r-1);)r--;n=e.indexOf(",")+1,i.size=Math.floor(.75*(r-n)),t()},i.readUint8Array=function(i,r,a){var o,s=d(r),c=4*Math.floor(i/3),u=4*Math.ceil((i+r)/3),f=t.atob(e.substring(c+n,u+n)),h=i-3*Math.floor(c/4);for(o=h;o<h+r;o++)s.array[o-h]=f.charCodeAt(o);a(s.array)}}function y(t){var e=this;e.size=0,e.init=function(n){e.size=t.size,n()},e.readUint8Array=function(e,n,i,r){var a=new FileReader;a.onload=function(t){i(new Uint8Array(t.target.result))},a.onerror=r;try{a.readAsArrayBuffer(function(t,e,n){if(e<0||n<0||e+n>t.size)throw new RangeError("offset:"+e+", length:"+n+", size:"+t.size);return t.slice?t.slice(e,e+n):t.webkitSlice?t.webkitSlice(e,e+n):t.mozSlice?t.mozSlice(e,e+n):t.msSlice?t.msSlice(e,e+n):void 0}(t,e,n))}catch(t){r(t)}}}function v(){}function _(t){var e;this.init=function(t){e=new Blob([],{type:h}),t()},this.writeUint8Array=function(t,n){e=new Blob([e,B?t:t.buffer],{type:h}),n()},this.getData=function(n,i){var r=new FileReader;r.onload=function(t){n(t.target.result)},r.onerror=i,r.readAsText(e,t)}}function b(e){var n="",i="";this.init=function(t){n+="data:"+(e||"")+";base64,",t()},this.writeUint8Array=function(e,r){var a,o=i.length,s=i;for(i="",a=0;a<3*Math.floor((o+e.length)/3)-o;a++)s+=String.fromCharCode(e[a]);for(;a<e.length;a++)i+=String.fromCharCode(e[a]);s.length>2?n+=t.btoa(s):i=s,r()},this.getData=function(e){e(n+t.btoa(i))}}function z(t){var e;this.init=function(n){e=new Blob([],{type:t}),n()},this.writeUint8Array=function(n,i){e=new Blob([e,B?n:n.buffer],{type:t}),i()},this.getData=function(t){t(e)}}function U(t,e,n,i,r,a,o,s,c,u){var h,l,p,d=0,g=e.sn;function m(){t.removeEventListener("message",w,!1),s(l,p)}function w(e){var n=e.data,r=n.data,s=n.error;if(s)return s.toString=function(){return"Error: "+this.message},void c(s);if(n.sn===g)switch("number"==typeof n.codecTime&&(t.codecTime+=n.codecTime),"number"==typeof n.crcTime&&(t.crcTime+=n.crcTime),n.type){case"append":r?(l+=r.length,i.writeUint8Array(r,function(){y()},u)):y();break;case"flush":p=n.crc,r?(l+=r.length,i.writeUint8Array(r,function(){m()},u)):m();break;case"progress":o&&o(h+n.loaded,a);break;case"importScripts":case"newTask":case"echo":break;default:console.warn("zip.js:launchWorkerProcess: unknown message: ",n)}}function y(){(h=d*f)<=a?n.readUint8Array(r+h,Math.min(f,a-h),function(n){o&&o(h,a);var i=0===h?e:{sn:g};i.type="append",i.data=n;try{t.postMessage(i,[n.buffer])}catch(e){t.postMessage(i)}d++},c):t.postMessage({sn:g,type:"flush"})}l=0,t.addEventListener("message",w,!1),y()}function A(t,e,n,i,r,a,o,s,c,u){var h,p=0,d=0,g="input"===a,m="output"===a,w=new l;!function a(){var l;if((h=p*f)<r)e.readUint8Array(i+h,Math.min(f,r-h),function(e){var i;try{i=t.append(e,function(t){o&&o(h+t,r)})}catch(t){return void c(t)}i?(d+=i.length,n.writeUint8Array(i,function(){p++,setTimeout(a,1)},u),m&&w.append(i)):(p++,setTimeout(a,1)),g&&w.append(e),o&&o(h,r)},c);else{try{l=t.flush()}catch(t){return void c(t)}l?(m&&w.append(l),d+=l.length,n.writeUint8Array(l,function(){s(d,w.get())},u)):s(d,w.get())}}()}function S(e,n,i,r,a,o,s,c,u,f,h){t.zip.useWebWorkers&&s?U(e,{sn:n,codecClass:"NOOP",crcType:"input"},i,r,a,o,u,c,f,h):A(new p,i,r,a,o,"input",u,c,f,h)}function C(t){var e,n,i="",r=["Ç","ü","é","â","ä","à","å","ç","ê","ë","è","ï","î","ì","Ä","Å","É","æ","Æ","ô","ö","ò","û","ù","ÿ","Ö","Ü","ø","£","Ø","×","ƒ","á","í","ó","ú","ñ","Ñ","ª","º","¿","®","¬","½","¼","¡","«","»","_","_","_","¦","¦","Á","Â","À","©","¦","¦","+","+","¢","¥","+","+","-","-","+","-","+","ã","Ã","+","+","-","-","¦","-","+","¤","ð","Ð","Ê","Ë","È","i","Í","Î","Ï","+","+","_","_","¦","Ì","_","Ó","ß","Ô","Ò","õ","Õ","µ","þ","Þ","Ú","Û","Ù","ý","Ý","¯","´","­","±","_","¾","¶","§","÷","¸","°","¨","·","¹","³","²","_"," "];for(e=0;e<t.length;e++)i+=(n=255&t.charCodeAt(e))>127?r[n-128]:String.fromCharCode(n);return i}function k(t){return decodeURIComponent(escape(t))}function E(t){var e,n="";for(e=0;e<t.length;e++)n+=String.fromCharCode(t[e]);return n}function L(t,e,n,a,o){t.version=e.view.getUint16(n,!0),t.bitFlag=e.view.getUint16(n+2,!0),t.compressionMethod=e.view.getUint16(n+4,!0),t.lastModDateRaw=e.view.getUint32(n+6,!0),t.lastModDate=function(t){var e=(4294901760&t)>>16,n=65535&t;try{return new Date(1980+((65024&e)>>9),((480&e)>>5)-1,31&e,(63488&n)>>11,(2016&n)>>5,2*(31&n),0)}catch(t){}}(t.lastModDateRaw),1!=(1&t.bitFlag)?((a||8!=(8&t.bitFlag))&&(t.crc32=e.view.getUint32(n+10,!0),t.compressedSize=e.view.getUint32(n+14,!0),t.uncompressedSize=e.view.getUint32(n+18,!0)),4294967295!==t.compressedSize&&4294967295!==t.uncompressedSize?(t.filenameLength=e.view.getUint16(n+22,!0),t.extraFieldLength=e.view.getUint16(n+24,!0)):o(r)):o(i)}function R(i,r,o){var u=0;function f(){}f.prototype.getData=function(r,a,f,h){var l=this;function p(t,e){h&&!function(t){var e=d(4);return e.view.setUint32(0,t),l.crc32==e.view.getUint32(0)}(e)?o(n):r.getData(function(t){a(t)})}function g(t){o(t||c)}function m(t){o(t||s)}i.readUint8Array(l.offset,30,function(n){var a,s=d(n.length,n);1347093252==s.view.getUint32(0)?(L(l,s,4,!1,o),a=l.offset+30+l.filenameLength+l.extraFieldLength,r.init(function(){0===l.compressionMethod?S(l._worker,u++,i,r,a,l.compressedSize,h,p,f,g,m):function(e,n,i,r,a,o,s,c,u,f,h){var l=s?"output":"none";t.zip.useWebWorkers?U(e,{sn:n,codecClass:"Inflater",crcType:l},i,r,a,o,u,c,f,h):A(new t.zip.Inflater,i,r,a,o,l,u,c,f,h)}(l._worker,u++,i,r,a,l.compressedSize,h,p,f,g,m)},m)):o(e)},g)};var h={getEntries:function(t){var n=this._worker;!function(t){var n=22;if(i.size<n)o(e);else{var r=n+65536;s(n,function(){s(Math.min(r,i.size),function(){o(e)})})}function s(e,r){i.readUint8Array(i.size-e,e,function(e){for(var i=e.length-n;i>=0;i--)if(80===e[i]&&75===e[i+1]&&5===e[i+2]&&6===e[i+3])return void t(new DataView(e.buffer,i,n));r()},function(){o(a)})}}(function(r){var s,c;s=r.getUint32(16,!0),c=r.getUint16(8,!0),s<0||s>=i.size?o(e):i.readUint8Array(s,i.size-s,function(i){var r,a,s,u,h=0,l=[],p=d(i.length,i);for(r=0;r<c;r++){if((a=new f)._worker=n,1347092738!=p.view.getUint32(h))return void o(e);L(a,p,h+6,!0,o),a.commentLength=p.view.getUint16(h+32,!0),a.directory=16==(16&p.view.getUint8(h+38)),a.offset=p.view.getUint32(h+42,!0),s=E(p.array.subarray(h+46,h+46+a.filenameLength)),a.filename=2048==(2048&a.bitFlag)?k(s):C(s),a.directory||"/"!=a.filename.charAt(a.filename.length-1)||(a.directory=!0),u=E(p.array.subarray(h+46+a.filenameLength+a.extraFieldLength,h+46+a.filenameLength+a.extraFieldLength+a.commentLength)),a.comment=2048==(2048&a.bitFlag)?k(u):C(u),l.push(a),h+=46+a.filenameLength+a.extraFieldLength+a.commentLength}t(l)},function(){o(a)})})},close:function(t){this._worker&&(this._worker.terminate(),this._worker=null),t&&t()},_worker:null};t.zip.useWebWorkers?W("inflater",function(t){h._worker=t,r(h)},function(t){o(t)}):r(h)}function x(t){return unescape(encodeURIComponent(t))}function D(t){var e,n=[];for(e=0;e<t.length;e++)n.push(t.charCodeAt(e));return n}function M(e,n,i,r){var a={},s=[],f=0,h=0;function l(t){i(t||o)}function p(t){i(t||c)}var g={add:function(n,o,c,g,m){var w,y,v,_=this._worker;function b(t,n){var i=d(16);f+=t||0,i.view.setUint32(0,1347094280),void 0!==n&&(w.view.setUint32(10,n,!0),i.view.setUint32(4,n,!0)),o&&(i.view.setUint32(8,t,!0),w.view.setUint32(14,t,!0),i.view.setUint32(12,o.size,!0),w.view.setUint32(18,o.size,!0)),e.writeUint8Array(i.array,function(){f+=16,c()},l)}function z(){m=m||{},n=n.trim(),m.directory&&"/"!=n.charAt(n.length-1)&&(n+="/"),a.hasOwnProperty(n)?i(u):(y=D(x(n)),s.push(n),function(t){var i;v=m.lastModDate||new Date,w=d(26),a[n]={headerArray:w.array,directory:m.directory,filename:y,offset:f,comment:D(x(m.comment||""))},w.view.setUint32(0,335546376),m.version&&w.view.setUint8(0,m.version),r||0===m.level||m.directory||w.view.setUint16(4,2048),w.view.setUint16(6,(v.getHours()<<6|v.getMinutes())<<5|v.getSeconds()/2,!0),w.view.setUint16(8,(v.getFullYear()-1980<<4|v.getMonth()+1)<<5|v.getDate(),!0),w.view.setUint16(22,y.length,!0),(i=d(30+y.length)).view.setUint32(0,1347093252),i.array.set(w.array,4),i.array.set(y,30),f+=i.array.length,e.writeUint8Array(i.array,t,l)}(function(){o?r||0===m.level?S(_,h++,o,e,0,o.size,!0,b,g,p,l):function(e,n,i,r,a,o,s,c,u){t.zip.useWebWorkers?U(e,{sn:n,options:{level:a},codecClass:"Deflater",crcType:"input"},i,r,0,i.size,s,o,c,u):A(new t.zip.Deflater,i,r,0,i.size,"input",s,o,c,u)}(_,h++,o,e,m.level,b,g,p,l):b()}))}o?o.init(z,p):z()},close:function(t){this._worker&&(this._worker.terminate(),this._worker=null);var n,i,r,o=0,c=0;for(i=0;i<s.length;i++)o+=46+(r=a[s[i]]).filename.length+r.comment.length;for(n=d(o+22),i=0;i<s.length;i++)r=a[s[i]],n.view.setUint32(c,1347092738),n.view.setUint16(c+4,5120),n.array.set(r.headerArray,c+6),n.view.setUint16(c+32,r.comment.length,!0),r.directory&&n.view.setUint8(c+38,16),n.view.setUint32(c+42,r.offset,!0),n.array.set(r.filename,c+46),n.array.set(r.comment,c+46+r.filename.length),c+=46+r.filename.length+r.comment.length;n.view.setUint32(c,1347093766),n.view.setUint16(c+8,s.length,!0),n.view.setUint16(c+10,s.length,!0),n.view.setUint32(c+12,o,!0),n.view.setUint32(c+16,f,!0),e.writeUint8Array(n.array,function(){e.getData(t)},l)},_worker:null};t.zip.useWebWorkers?W("deflater",function(t){g._worker=t,n(g)},function(t){i(t)}):n(g)}l.prototype.append=function(t){for(var e=0|this.crc,n=this.table,i=0,r=0|t.length;i<r;i++)e=e>>>8^n[255&(e^t[i])];this.crc=e},l.prototype.get=function(){return~this.crc},l.prototype.table=function(){var t,e,n,i=[];for(t=0;t<256;t++){for(n=t,e=0;e<8;e++)1&n?n=n>>>1^3988292384:n>>>=1;i[t]=n}return i}(),p.prototype.append=function(t,e){return t},p.prototype.flush=function(){},m.prototype=new g,m.prototype.constructor=m,w.prototype=new g,w.prototype.constructor=w,y.prototype=new g,y.prototype.constructor=y,v.prototype.getData=function(t){t(this.data)},_.prototype=new v,_.prototype.constructor=_,b.prototype=new v,b.prototype.constructor=b,z.prototype=new v,z.prototype.constructor=z;var T={deflater:["z-worker.js","deflate.js"],inflater:["z-worker.js","inflate.js"]};function W(e,n,i){if(null===t.zip.workerScripts||null===t.zip.workerScriptsPath){var r;if(t.zip.workerScripts){if(r=t.zip.workerScripts[e],!Array.isArray(r))return void i(new Error("zip.workerScripts."+e+" is not an array!"));r=function(t){var e=document.createElement("a");return t.map(function(t){return e.href=t,e.href})}(r)}else(r=T[e].slice(0))[0]=(t.zip.workerScriptsPath||"")+r[0];var a=new Worker(r[0]);a.codecTime=a.crcTime=0,a.postMessage({type:"importScripts",scripts:r.slice(1)}),a.addEventListener("message",function t(e){var r=e.data;if(r.error)return a.terminate(),void i(r.error);"importScripts"===r.type&&(a.removeEventListener("message",t),a.removeEventListener("error",o),n(a))}),a.addEventListener("error",o)}else i(new Error("Either zip.workerScripts or zip.workerScriptsPath may be set, not both."));function o(t){a.terminate(),i(t)}}function H(t){console.error(t)}t.zip={Reader:g,Writer:v,BlobReader:y,Data64URIReader:w,TextReader:m,BlobWriter:z,Data64URIWriter:b,TextWriter:_,createReader:function(t,e,n){n=n||H,t.init(function(){R(t,e,n)},n)},createWriter:function(t,e,n,i){n=n||H,i=!!i,t.init(function(){M(t,e,n,i)},n)},useWebWorkers:!0,workerScriptsPath:null,workerScripts:null};var F,B,I="HTTP Range not supported.",g=t.zip.Reader,v=t.zip.Writer;try{B=0===new Blob([new DataView(new ArrayBuffer(0))]).size}catch(t){}function j(t){var e=this;function n(n,i){var r;e.data?n():((r=new XMLHttpRequest).addEventListener("load",function(){e.size||(e.size=Number(r.getResponseHeader("Content-Length"))||Number(r.response.byteLength)),e.data=new Uint8Array(r.response),n()},!1),r.addEventListener("error",i,!1),r.open("GET",t),r.responseType="arraybuffer",r.send())}e.size=0,e.init=function(i,r){if(function(t){var e=document.createElement("a");return e.href=t,"http:"===e.protocol||"https:"===e.protocol}(t)){var a=new XMLHttpRequest;a.addEventListener("load",function(){e.size=Number(a.getResponseHeader("Content-Length")),e.size?i():n(i,r)},!1),a.addEventListener("error",r,!1),a.open("HEAD",t),a.send()}else n(i,r)},e.readUint8Array=function(t,i,r,a){n(function(){r(new Uint8Array(e.data.subarray(t,t+i)))},a)}}function P(t){var e=this;e.size=0,e.init=function(n,i){var r=new XMLHttpRequest;r.addEventListener("load",function(){e.size=Number(r.getResponseHeader("Content-Length")),"bytes"==r.getResponseHeader("Accept-Ranges")?n():i(I)},!1),r.addEventListener("error",i,!1),r.open("HEAD",t),r.send()},e.readUint8Array=function(e,n,i,r){!function(e,n,i,r){var a=new XMLHttpRequest;a.open("GET",t),a.responseType="arraybuffer",a.setRequestHeader("Range","bytes="+e+"-"+(e+n-1)),a.addEventListener("load",function(){i(a.response)},!1),a.addEventListener("error",r,!1),a.send()}(e,n,function(t){i(new Uint8Array(t))},r)}}function O(t){var e=this;e.size=0,e.init=function(n,i){e.size=t.byteLength,n()},e.readUint8Array=function(e,n,i,r){i(new Uint8Array(t.slice(e,e+n)))}}function X(){var t;this.init=function(e,n){t=new Uint8Array,e()},this.writeUint8Array=function(e,n,i){var r=new Uint8Array(t.length+e.length);r.set(t),r.set(e,t.length),t=r,n()},this.getData=function(e){e(t.buffer)}}function N(t,e){var n;this.init=function(e,i){t.createWriter(function(t){n=t,e()},i)},this.writeUint8Array=function(t,i,r){var a=new Blob([B?t:t.buffer],{type:e});n.onwrite=function(){n.onwrite=null,i()},n.onerror=r,n.write(a)},this.getData=function(e){t.file(e)}}j.prototype=new g,j.prototype.constructor=j,P.prototype=new g,P.prototype.constructor=P,O.prototype=new g,O.prototype.constructor=O,X.prototype=new v,X.prototype.constructor=X,N.prototype=new v,N.prototype.constructor=N,t.zip.FileWriter=N,t.zip.HttpReader=j,t.zip.HttpRangeReader=P,t.zip.ArrayBufferReader=O,t.zip.ArrayBufferWriter=X,t.zip.fs&&((F=t.zip.fs.ZipDirectoryEntry).prototype.addHttpContent=function(e,n,i){return function(e,n,i,r){if(e.directory)return r?new F(e.fs,n,i,e):new t.zip.fs.ZipFileEntry(e.fs,n,i,e);throw"Parent entry is not a directory."}(this,e,{data:n,Reader:i?P:j})},F.prototype.importHttpContent=function(t,e,n,i){this.importZip(e?new P(t):new j(t),n,i)},t.zip.fs.FS.prototype.importHttpContent=function(t,e,n,i){this.entries=[],this.root=new F(this),this.root.importHttpContent(t,e,n,i)})}(this)},function(t,e,n){"use strict";n.r(e);class i{constructor(t,e){this.image=t,this.metainfo=e}seamImageData(t,e){const n=new ImageData(t,e),i=this.binarySearch(t,this.metainfo.widthKeys),r=(this.binarySearch(e,this.metainfo.heightKeys),this.image.width-i);if(r>=0)for(let e=0;e<this.image.height;e++){let i=0;for(let a=0;a<this.image.width;a++)if(this.metainfo.seamMap[e][a]>=r){const r=4*(e*t+i),o=4*(e*this.image.width+a);n.data[r]=this.image.data[o],n.data[r+1]=this.image.data[o+1],n.data[r+2]=this.image.data[o+2],n.data[r+3]=this.image.data[o+3],i++}}else for(let e=0;e<this.image.height;e++){let i=0;for(let a=0;a<this.image.width;a++){if(this.metainfo.seamMap[e][a]<=-r){const r=4*(e*t+i),o=4*(e*this.image.width+a);n.data[r]=this.image.data[o],n.data[r+1]=this.image.data[o+1],n.data[r+2]=this.image.data[o+2],n.data[r+3]=this.image.data[o+3],i++}const o=4*(e*t+i),s=4*(e*this.image.width+a);n.data[o]=this.image.data[s],n.data[o+1]=this.image.data[s+1],n.data[o+2]=this.image.data[s+2],n.data[o+3]=this.image.data[s+3],i++}}return console.log(n),n}originX(t){return this.binarySearch(t,this.metainfo.originXKeys)}originY(t){return this.binarySearch(t,this.metainfo.originYKeys)}scaleX(t){return this.binarySearch(t,this.metainfo.scaleXKeys)}scaleY(t){return this.binarySearch(t,this.metainfo.scaleYKeys)}binarySearch(t,e){let n=-1,i=e.length;for(;i-n>1;){const r=Math.floor((n+i)/2);e[r][0]>=t?i=r:n=r}if(1===e.length)return e[0][1];if(i===e.length){const n=e[i-2][1],r=e[i-1][1],a=e[i-1][0]-e[i-2][0],o=t-e[i-1][0];return 0===a?r:r+(r-n)/a*o}if(e[i][0]===t)return e[i][1];if(0===i){const n=e[i+1][1],r=e[i][1],a=e[i][0]-e[i+1][0],o=t-e[i][0];return 0===a?r:r+(r-n)/a*o}{const n=e[i-1][1],r=e[i][1],a=e[i][0]-e[i-1][0],o=e[i][0]-t;return 0===a?n:n+(r-n)/a*o}}}var r=n(0);customElements.define("m-img",class extends HTMLElement{constructor(){super(),this._msiSrc=null,this._timer=0,this._resizer=null,this._metainfo=null,this._fileUrl=null,this._scriptPath=function(){if(document.currentScript)return document.currentScript;{let t=document.getElementsByTagName("script");if(script=t[t.length-1],script.src)return script.src}}().src.split("/").slice(0,-1).join("/");const t=this.attachShadow({mode:"open"}),e=document.createElement("div");e.setAttribute("class","wrapper"),this._canvas=document.createElement("canvas"),this._canvas.setAttribute("class","main_canvas"),this._mainCtx=this._canvas.getContext("2d"),this._imageCanvas=document.createElement("canvas"),this._imageCanvas.setAttribute("class","hidden_canvas"),this._imageCtx=this._imageCanvas.getContext("2d");const n=document.createElement("style");n.textContent="\n      .wrapper {\n        display: block;\n        width: 100%;\n        height: 100%;\n        padding: 0;\n        margin: 0;\n        overflow: hidden;\n      }\n      \n      .main_canvas {\n        display: block;\n        margin: 0;\n        padding: 0;\n      }\n      \n      .hidden_canvas {\n        display: none;\n      }\n    ",t.appendChild(n),t.appendChild(e),e.appendChild(this._canvas),e.appendChild(this._imageCanvas)}static get observedAttributes(){return["src"]}attributeChangedCallback(t,e,n){this._msiSrc=n,e!==n&&this._updateSrc()}connectedCallback(){this._updateSrc()}get src(){return this._msiSrc}set src(t){this.setAttribute("src",t)}_onresize(){this._timer>0&&clearTimeout(this._timer);const t=this;this._timer=setTimeout(function(){t._drawImage()},200)}_drawImage(){const t=this.clientWidth,e=this.clientHeight,n=this._resizer.seamImageData(t,e),i=this._resizer.originX(t),r=this._resizer.originY(e),a=this._resizer.scaleX(t),o=this._resizer.scaleY(e);this._canvas.width=t,this._canvas.height=e,this._imageCtx.clearRect(0,0,this._imageCanvas.width,this._imageCanvas.height),this._imageCtx.putImageData(n,0,0),this._mainCtx.clearRect(0,0,t,e),this._mainCtx.scale(a,o),this._mainCtx.drawImage(this._imageCanvas,i,r),this._mainCtx.scale(1/a,1/o)}_updateSrc(){if(!this._msiSrc)return this._mainCtx.clearRect(0,0,this._mainCtx.width,this._mainCtx.height),this._imageCtx.clearRect(0,0,this._imageCtx.width,this._imageCtx.height),this._msiSrc=null,this._timer=0,this._resizer=null,this._unzipTimer=0,this._metainfo=null,void(this._fileUrl=null);const t=this;r.zip.workerScripts={deflater:[this._scriptPath+"/worker_pako.js"],inflater:[this._scriptPath+"/worker_pako.js"]},r.zip.createReader(new r.zip.HttpReader(this._msiSrc),function(e){e.getEntries(function(e){for(const n of e)"metainfo.json"===n.filename?n.getData(new r.zip.TextWriter,function(e){t._metainfo=JSON.parse(e)}):n.getData(new r.zip.BlobWriter,function(e){t._fileUrl=URL.createObjectURL(e)});let n=setInterval(function(){t._metainfo&&t._fileUrl&&(t._image=new Image,t._image.src=t._fileUrl,t._image.onload=(()=>{const e=document.createElement("canvas"),n=e.getContext("2d");e.width=t._image.naturalWidth,e.height=t._image.naturalHeight,n.drawImage(t._image,0,0,t._image.naturalWidth,t._image.naturalHeight),t._resizer=new i(n.getImageData(0,0,t._image.naturalWidth,t._image.naturalHeight),t._metainfo),t._drawImage()}),clearInterval(n))},100)})})}}),window.addEventListener("resize",function(){const t=document.getElementsByTagName("m-img");for(const e of t)e._onresize()})}]);